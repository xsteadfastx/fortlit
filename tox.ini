[tox]
envlist = py36, flake8, pylint, mypy

[testenv]
deps =
    pipenv
commands =
    pipenv install --dev
    pipenv run pytest

[testenv:flake8]
basepython = python3.6
deps =
    pipenv
commands =
    pipenv install --dev
    pipenv run flake8 {toxinidir}/setup.py
    pipenv run flake8 {toxinidir}/src/fortlit/__init__.py
    pipenv run flake8 {toxinidir}/src/fortlit/lit_time.py
    pipenv run flake8 {toxinidir}/tests/test_lit_time.py

[testenv:pylint]
basepython = python3.6
deps =
    pipenv
commands =
    pipenv install --dev
    pipenv run pylint --rcfile={toxinidir}/setup.cfg {toxinidir}/setup.py
    pipenv run pylint --rcfile={toxinidir}/setup.cfg {toxinidir}/src/fortlit/__init__.py
    pipenv run pylint --rcfile={toxinidir}/setup.cfg {toxinidir}/src/fortlit/lit_time.py
    pipenv run pylint --rcfile={toxinidir}/setup.cfg {toxinidir}/tests/test_lit_time.py

[testenv:mypy]
basepython = python3.6
deps =
    pipenv
commands =
    pipenv install --dev
    pipenv run mypy --ignore-missing-imports --follow-imports=skip --strict-optional {toxinidir}/setup.py
    pipenv run mypy --ignore-missing-imports --follow-imports=skip --strict-optional {toxinidir}/src/fortlit/__init__.py
    pipenv run mypy --ignore-missing-imports --follow-imports=skip --strict-optional {toxinidir}/src/fortlit/lit_time.py

[testenv:pex]
basepython = python3.6
whitelist_external = /bin/bash
deps =
    pex
commands =
    /bin/bash -c "pex . -e fortlit:entrypoint -o {toxinidir}/dist/fortlit-`uname -s`-`uname -m`.pex -v"
